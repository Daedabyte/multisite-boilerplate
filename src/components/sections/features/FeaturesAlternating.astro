---
/**
 * FeaturesAlternating
 *
 * Zigzag/alternating layout with image and content side by side.
 * Each feature row alternates image position left/right.
 *
 * @variant alternating
 * @since 1.0.0
 *
 * Best for: Detailed feature explanations, product walkthroughs, process steps
 * Avoid when: Features don't have strong visual imagery
 *
 * @example
 * <FeaturesAlternating
 *   heading="How It Works"
 *   features={[
 *     {
 *       title: 'Step 1',
 *       description: 'Get started easily',
 *       image: { src: '/step1.jpg', alt: 'Step 1' }
 *     }
 *   ]}
 * />
 */

import type { FeaturesBaseProps, FeatureItem } from './types';
import type { ImageProps } from '@types';
import Container from '@components/layout/Container.astro';

/**
 * Alternating features variant props
 */
interface Props extends Omit<FeaturesBaseProps, 'features'> {
  /** Features must include images for this variant */
  features: Array<FeatureItem & { image: ImageProps }>;
}

const {
  heading,
  subheading,
  features,
  background,
  container,
  classList,
  id = 'features',
  ...attrs
} = Astro.props;
---

<section
  id={id}
  class:list={[
    'features',
    'features--alternating',
    background?.variant === 'alt' && 'features--alt',
    classList
  ]}
  {...attrs}
>
  <Container {...container}>
    {(heading || subheading) && (
      <div class="features__header">
        {heading && <h2 class="features__heading">{heading}</h2>}
        {subheading && <p class="features__subheading">{subheading}</p>}
      </div>
    )}

    <div class="features__rows">
      {features.map((feature, index) => (
        <div class={`features__row ${index % 2 === 1 ? 'features__row--reverse' : ''}`}>
          <div class="features__row-image">
            <img src={feature.image.src} alt={feature.image.alt || ''} />
          </div>
          <div class="features__row-content">
            {feature.icon && (
              <div class="features__icon">
                <i class={feature.icon} aria-hidden="true"></i>
              </div>
            )}
            <h3 class="features__title">{feature.title}</h3>
            <p class="features__description">{feature.description}</p>
            {feature.link && (
              <a href={feature.link.href} class="features__link">
                {feature.link.label || 'Learn more'} â†’
              </a>
            )}
          </div>
        </div>
      ))}
    </div>

    <slot />
  </Container>
</section>

<style lang="scss" is:global>
  @use './features.scss';
</style>

<style lang="scss">
  @use '../../../styles/abstracts' as *;

  // Variant: Alternating
  .features--alternating {
    .features__rows {
      display: flex;
      flex-direction: column;
      gap: var(--space-16);
    }

    .features__row {
      display: grid;
      gap: var(--space-8);
      align-items: center;

      @include media-up('lg') {
        grid-template-columns: 1fr 1fr;
        gap: var(--space-12);
      }
    }

    .features__row--reverse {
      @include media-up('lg') {
        .features__row-image {
          order: 1;
        }
      }
    }

    .features__row-image {
      border-radius: var(--border-radius-xl);
      overflow: hidden;

      img {
        width: 100%;
        height: auto;
        display: block;
      }
    }

    .features__row-content {
      .features__title {
        font-size: var(--font-size-xl);

        @include media-up('lg') {
          font-size: var(--font-size-xxl);
        }
      }

      .features__description {
        font-size: var(--font-size-lg);
      }
    }

    .features__icon {
      width: 4rem;
      height: 4rem;
      font-size: var(--font-size-xxl);
    }
  }
</style>
