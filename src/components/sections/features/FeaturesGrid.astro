---
/**
 * FeaturesGrid
 *
 * Card grid layout for displaying features with icons or images.
 * Responsive columns adapt from single column on mobile to configurable grid.
 *
 * @variant grid
 * @since 1.0.0
 *
 * Best for: Service showcases, product features, benefit lists
 * Avoid when: Need alternating image/content layout
 *
 * @example
 * <FeaturesGrid
 *   heading="Our Features"
 *   subheading="Everything you need to succeed"
 *   features={[
 *     { title: 'Fast', description: 'Lightning quick', icon: 'fa-bolt' }
 *   ]}
 *   columns={3}
 * />
 */

import type { FeaturesBaseProps, FeaturesColumns } from './types';
import Container from '@components/layout/Container.astro';

/**
 * Grid features variant props
 */
interface Props extends FeaturesBaseProps {
  /** Number of columns */
  columns?: FeaturesColumns;
}

const {
  heading,
  subheading,
  features,
  columns = 3,
  background,
  container,
  classList,
  id = 'features',
  ...attrs
} = Astro.props;
---

<section
  id={id}
  class:list={[
    'features',
    'features--grid',
    `features--cols-${columns}`,
    background?.variant === 'alt' && 'features--alt',
    classList
  ]}
  {...attrs}
>
  <Container {...container}>
    {(heading || subheading) && (
      <div class="features__header">
        {heading && <h2 class="features__heading">{heading}</h2>}
        {subheading && <p class="features__subheading">{subheading}</p>}
      </div>
    )}

    <div class="features__grid">
      {features.map((feature) => (
        <div class="features__item">
          {feature.icon && (
            <div class="features__icon">
              <i class={feature.icon} aria-hidden="true"></i>
            </div>
          )}
          {feature.image && (
            <div class="features__image">
              <img src={feature.image.src} alt={feature.image.alt || ''} />
            </div>
          )}
          <h3 class="features__title">{feature.title}</h3>
          <p class="features__description">{feature.description}</p>
          {feature.link && (
            <a href={feature.link.href} class="features__link">
              {feature.link.label || 'Learn more'} â†’
            </a>
          )}
        </div>
      ))}
    </div>

    <slot />
  </Container>
</section>

<style lang="scss" is:global>
  @use './features.scss';
</style>

<style lang="scss">
  @use '../../../styles/abstracts' as *;

  // Variant: Grid
  .features--grid {
    .features__grid {
      display: grid;
      gap: var(--space-8);

      @include media-up('md') {
        gap: var(--space-10);
      }
    }

    .features__item {
      text-align: center;
    }

    &.features--cols-2 {
      .features__grid {
        @include media-up('md') {
          grid-template-columns: repeat(2, 1fr);
        }
      }
    }

    &.features--cols-3 {
      .features__grid {
        @include media-up('md') {
          grid-template-columns: repeat(2, 1fr);
        }

        @include media-up('lg') {
          grid-template-columns: repeat(3, 1fr);
        }
      }
    }

    &.features--cols-4 {
      .features__grid {
        @include media-up('sm') {
          grid-template-columns: repeat(2, 1fr);
        }

        @include media-up('lg') {
          grid-template-columns: repeat(4, 1fr);
        }
      }
    }
  }
</style>
