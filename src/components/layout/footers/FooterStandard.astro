---
/**
 * FooterStandard
 *
 * Multi-column footer with brand info, link groups, and social links.
 * Full-featured footer suitable for most websites.
 *
 * @variant standard
 * @since 1.0.0
 *
 * Best for: Corporate sites, e-commerce, content-heavy sites
 * Avoid when: Minimal/single-page sites
 *
 * @example
 * <FooterStandard
 *   logo={{ src: logoImg, alt: 'Company' }}
 *   description="Your company description"
 *   linkGroups={footerLinks}
 *   socialLinks={socials}
 * />
 */

import type { FooterBaseProps } from './types';
import type { FooterLinkGroup, SocialLink } from '@types';
import Container from '@components/layout/Container.astro';
import { Image } from 'astro:assets';
import { config, footerLinkGroups, footerSocialLinks } from '@data/config';
import logoIcon from '@assets/images/logo_icon.png';

/**
 * Standard footer variant props
 */
interface Props extends FooterBaseProps {
  /** Link groups for footer columns */
  linkGroups?: FooterLinkGroup[];
  /** Social media links */
  socialLinks?: SocialLink[];
  /** Contact information */
  contact?: {
    phone?: string;
    phoneFormatted?: string;
    email?: string;
    address?: string;
    city?: string;
    state?: string;
    zip?: string;
  };
  /** Attribution/credit message */
  attribution?: {
    message: string;
    link?: {
      href: string;
      label: string;
    };
  };
}

const {
  logo,
  description = config.siteDescription,
  copyright,
  linkGroups = footerLinkGroups ?? [],
  socialLinks = footerSocialLinks ?? [],
  contact = config.company,
  attribution,
  container,
  classList,
  ...attrs
} = Astro.props;

const currentYear = new Date().getFullYear();
const copyrightText = copyright ?? `Â© ${currentYear} ${config.siteName}. All rights reserved.`;
---

<footer class:list={['footer', 'footer--standard', classList]} role="contentinfo" {...attrs}>
  <Container {...container}>
    <div class="footer__top">
      <div class="footer__brand">
        <a href={logo?.href ?? '/'} class="footer__logo-link" aria-label="Home">
          {logo?.src && typeof logo.src !== 'string' ? (
            <Image
              src={logo.src}
              alt={logo.alt}
              width={logo.width ?? 120}
              height={logo.height ?? 40}
              class="footer__logo"
              loading="lazy"
            />
          ) : logo?.src && typeof logo.src === 'string' ? (
            <img
              src={logo.src}
              alt={logo.alt}
              width={logo.width ?? 120}
              height={logo.height ?? 40}
              class="footer__logo"
              loading="lazy"
            />
          ) : (
            <Image
              src={logoIcon}
              alt="Site Logo"
              width={40}
              height={40}
              class="footer__logo"
              loading="lazy"
            />
          )}
        </a>
        {description && <p class="footer__description">{description}</p>}

        {contact && (
          <div class="footer__contact">
            {contact.phoneFormatted && (
              <a href={`tel:${contact.phone}`} class="footer__link">
                <i class="fa-solid fa-phone"></i>{contact.phoneFormatted}
              </a>
            )}
            {contact.email && (
              <a href={`mailto:${contact.email}`} class="footer__link">
                <i class="fa-solid fa-envelope"></i>{contact.email}
              </a>
            )}
            {contact.address && (
              <span class="footer__link">
                <i class="fa-solid fa-map-pin"></i>
                {contact.address}{contact.city && `, ${contact.city}`}{contact.state && `, ${contact.state}`} {contact.zip}
              </span>
            )}
          </div>
        )}
      </div>

      {linkGroups.length > 0 && (
        <nav class="footer__nav" aria-label="Footer navigation">
          {linkGroups.map((group) => (
            <div class="footer__section">
              <h3 class="footer__title">{group.title}</h3>
              <ul class="footer__list">
                {group.links.map((link) => (
                  <li>
                    <a
                      href={link.href}
                      class="footer__link"
                      {...link.external ? { target: '_blank', rel: 'noopener noreferrer' } : {}}
                    >
                      {link.label}
                    </a>
                  </li>
                ))}
              </ul>
            </div>
          ))}
        </nav>
      )}
    </div>

    <div class="footer__bottom">
      <div class="footer__bottom-content">
        <p class="footer__copyright">{copyrightText}</p>

        {socialLinks.length > 0 && (
          <div class="footer__social">
            {socialLinks.map((social) => (
              <a
                href={social.url}
                class="footer__social-link"
                aria-label={social.label ?? social.platform}
                target="_blank"
                rel="noopener noreferrer"
              >
                <i class={`fa-brands fa-${social.platform}`}></i>
              </a>
            ))}
          </div>
        )}
      </div>

      {attribution && (
        <div class="footer__attribution">
          {attribution.message}
          {attribution.link && (
            <a href={attribution.link.href} class="footer__link" target="_blank" rel="noopener noreferrer">
              {attribution.link.label}
            </a>
          )}
        </div>
      )}

      <slot name="attribution" />
    </div>
  </Container>
</footer>

<style lang="scss" is:global>
  @use './footers.scss';
</style>

<style lang="scss">
  @use '../../../styles/abstracts' as *;

  // Variant: Standard (multi-column)
  .footer--standard {
    .footer__top {
      display: grid;
      gap: var(--space-8);
      padding-block: var(--space-12);

      @include media-up('lg') {
        grid-template-columns: 1fr 2fr;
        gap: var(--space-12);
      }
    }

    .footer__brand {
      max-width: 20rem;
    }

    .footer__nav {
      display: grid;
      gap: var(--space-8);

      @include media-up('md') {
        grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      }
    }

    .footer__bottom {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border-top: 1px solid var(--color-neutral-600);
    }

    .footer__bottom-content {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-4);
      padding-block: var(--space-6);
      width: 100%;
    }
  }
</style>
