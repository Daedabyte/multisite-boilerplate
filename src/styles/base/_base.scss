@use 'sass:map';
@use 'sass:color';

@use '../abstracts' as *;

// ===================================
// CSS Custom Properties Generation
// ===================================

:root {
  // Design tokens
  @include generate-color-properties();
  @include generate-font-properties();
  @include generate-utility-properties();
  @include generate-component-properties();

  // Color scheme support
  color-scheme: light dark;
}

// ===================================
// Dark Mode Configuration
// Uncomment and customize as needed
// ===================================

/*
[data-theme="dark"],
.dark {
  // Invert neutral scale for dark mode
  --color-background: #{color('neutral', 900)};
  --color-surface: #{color('neutral', 800)};
  --color-border: #{color('neutral', 700)};
  --color-text: #{color('neutral', 50)};
  --color-text-muted: #{color('neutral', 400)};
  --color-text-subtle: #{color('neutral', 500)};

  // Component overrides
  --card-background: var(--color-neutral-800);
  --card-border-color: var(--color-neutral-700);
  --header-background: var(--color-neutral-900);
  --footer-background: var(--color-neutral-900);
}

@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    --color-background: #{color('neutral', 900)};
    --color-surface: #{color('neutral', 800)};
    --color-border: #{color('neutral', 700)};
    --color-text: #{color('neutral', 50)};
    --color-text-muted: #{color('neutral', 400)};
    --color-text-subtle: #{color('neutral', 500)};
  }
}
*/

// ===================================
// Smooth Scrolling & Reduced Motion
// ===================================

html {
  scroll-behavior: smooth;

  @media (prefers-reduced-motion: reduce) {
    scroll-behavior: auto;
  }
}

// ===================================
// Scroll Lock (for modals/drawers)
// Prevents body scroll while maintaining visual position
// ===================================

body.scroll-locked {
  overflow: hidden;
  // Prevent layout shift from scrollbar disappearing
  padding-right: var(--scrollbar-width, 0);

  // Keep header fixed in same position
  .header {
    padding-right: var(--scrollbar-width, 0);
  }
}

// ===================================
// Body Enhancements
// (Base styles in _reset.scss)
// ===================================

body {
  // Prevent horizontal overflow from animations/transforms
  overflow-x: hidden;

  // Ensure body fills viewport
  display: flex;
  flex-direction: column;
}

// ===================================
// Main Content Area
// ===================================

main {
  position: relative;
  z-index: 1;
  flex: 1; // Push footer to bottom in flex body
}

// ===================================
// Selection Styling
// ===================================

::selection {
  background-color: color.change(color('primary', 500), $alpha: 0.2);
  color: var(--color-neutral-900);
}

// ===================================
// Focus Styles
// (Enhanced from _reset.scss)
// ===================================

// Remove default focus for mouse users
:focus:not(:focus-visible) {
  outline: none;
}

// Enhanced focus for keyboard users
:focus-visible {
  outline: 2px solid var(--color-primary);
  outline-offset: 2px;
}

// Skip to content link styling handled in _utilities.scss

// ===================================
// Table Enhancements
// ===================================

table {
  border-collapse: collapse;
  width: 100%;
  margin-bottom: var(--space-4);
}

th,
td {
  padding: var(--space-3);
  text-align: left;
  border-bottom: 1px solid var(--color-neutral-200);
  vertical-align: top;
}

th {
  font-weight: var(--font-weight-semibold);
  border-bottom-width: 2px;
  color: var(--color-neutral-900);
  background-color: var(--color-neutral-50);
}

// Striped tables
.table-striped tbody tr:nth-child(odd) {
  background-color: var(--color-neutral-50);
}

// Hoverable tables
.table-hover tbody tr {
  transition: background-color var(--transition-fast);

  &:hover {
    background-color: var(--color-neutral-100);
  }
}

// ===================================
// Scrollbar Styling
// ===================================

// Modern scrollbar (Firefox)
* {
  scrollbar-width: thin;
  scrollbar-color: var(--color-neutral-400) var(--color-neutral-100);
}

// Webkit scrollbar
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-neutral-100);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb {
  background: var(--color-neutral-400);
  border-radius: 4px;
  border: 2px solid var(--color-neutral-100);

  &:hover {
    background: var(--color-neutral-500);
  }
}

// ===================================
// Print Styles
// ===================================

@media print {
  *,
  *::before,
  *::after {
    background: transparent !important;
    color: black !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  a,
  a:visited {
    text-decoration: underline;
  }

  a[href]::after {
    content: " (" attr(href) ")";
  }

  // Don't show links for images, internal anchors
  a[href^="#"]::after,
  a[href^="javascript:"]::after {
    content: "";
  }

  pre,
  blockquote {
    border: 1px solid var(--color-neutral-500);
    page-break-inside: avoid;
  }

  img {
    max-width: 100% !important;
    page-break-inside: avoid;
  }

  h2,
  h3 {
    page-break-after: avoid;
  }

  // Hide non-essential elements
  header,
  footer,
  nav,
  .no-print {
    display: none !important;
  }
}