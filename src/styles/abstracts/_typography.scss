@use 'sass:map';

// ===================================
// Font Retrieval Functions with Error Handling
// ===================================

/// Get a font family from the font family map with error handling
/// @param {Map} $font-families - Complete font family map
/// @param {String} $name - Font family name (e.g., 'heading')
/// @return {String} - Font family value
/// @error If the family does not exist in the map
/// @example get-font-family($font-families, 'heading') // returns 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif'
@function get-font-family($font-families, $name) {
    @if not map.has-key($font-families, $name) {
        @error "Font family '#{$name}' not found. Available families: #{map.keys($font-families)}";
    }
    @return map.get($font-families, $name);
}

/// Get a font size from the font size map with error handling
/// @param {Map} $font-sizes - Complete font size map
/// @param {String} $name - Font size name (e.g., 'base')
/// @return {String} - Font size value
/// @error If the size does not exist in the map
/// @example get-font-size($font-sizes, 'base') // returns 1rem
@function get-font-size($font-sizes, $name) {
    @if not map.has-key($font-sizes, $name) {
        @error "Font size '#{$name}' not found. Available sizes: #{map.keys($font-sizes)}";
    }
    @return map.get($font-sizes, $name);
}

/// Get a font weight from the font weight map with error handling
/// @param {Map} $font-weights - Complete font weight map
/// @param {String} $name - Font weight name (e.g., 'normal')
/// @return {String} - Font weight value
/// @error If the weight does not exist in the map
/// @example get-font-weight($font-weights, 'normal') // returns 400
@function get-font-weight($font-weights, $name) {
    @if not map.has-key($font-weights, $name) {
        @error "Font weight '#{$name}' not found. Available weights: #{map.keys($font-weights)}";
    }
    @return map.get($font-weights, $name);
}

// ===================================
// Font Access Functions - For SCSS Use
// ===================================

/// Shortcut function to get a font family
/// @param {String} $name - Font family name (e.g., 'heading')
/// @return {String} - Font family value
/// @example font-family('heading') // returns 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif'
/// @see get-font-family()
@function font-family($name) {
    @return get-font-family($brand-fonts, $name);
}

/// Shortcut function to get a font size
/// @param {String} $name - Font size name (e.g., 'base')
/// @return {String} - Font size value
/// @example font-size('base') // returns 1rem
/// @see get-font-size()
@function font-size($name) {
    @return get-font-size($font-sizes, $name);
}

/// Shortcut function to get a font weight
/// @param {String} $name - Font weight name (e.g., 'normal')
/// @return {String} - Font weight value
/// @example font-weight('normal') // returns 400
/// @see get-font-weight()
@function font-weight($name) {
    @return get-font-weight($font-weights, $name);
}

// ===================================
// Generate CSS Root Variables for Fonts
// ===================================
@mixin generate-font-properties() {
    @each $name, $font in $brand-fonts {
        --font-family-#{$name}: #{$font};
    }

    @each $name, $size in $font-sizes {
        --font-size-#{$name}: #{ $size };
    }

    @each $name, $weight in $font-weights {
        --font-weight-#{$name}: #{ $weight };
    }

    @each $name, $height in $line-heights {
        --line-height-#{$name}: #{ $height };
    }

    --font-size-root: #{$font-size-base};
}

// ===================================
// Brand Font Families
// ===================================
$brand-fonts: (
    "heading": ("Google Sans Code", monospace),
    "body": ("Zen Dots", sans-serif),
    "monospace": ('Courier New', 'Courier', monospace)
);

// ===================================
// Typography Scale and Weights
// ===================================
$font-size-base: 1rem;
$line-height-base: 1.6;

// Line height scale
$line-heights: (
  'tight': 1.25,
  'snug': 1.375,
  'normal': 1.5,
  'base': 1.6,
  'relaxed': 1.7,
  'loose': 2,
);

$font-sizes: (
  'xs': 0.75rem,
  'sm': 0.875rem,
  'base': 1rem,
  'lg': 1.125rem,
  'xl': 1.25rem,
  '2xl': 1.5rem,
  '3xl': 1.875rem,
  '4xl': 2.25rem,
  'xxl': 3rem,
  '2xxl': 4rem,
  '3xxl': 5rem,
  '4xxl': 6rem
);

$font-weights: (
  'light': 300,
  'normal': 400,
  'medium': 500,
  'semibold': 600,
  'bold': 700
);

// ===================================
// Fluid Typography
// Automatically scales font sizes between viewport widths
// ===================================

/// Calculate fluid font size using clamp()
/// @param {Number} $min-size - Minimum font size (in rem)
/// @param {Number} $max-size - Maximum font size (in rem)
/// @param {Number} $min-vw - Minimum viewport width (in px), default 320px
/// @param {Number} $max-vw - Maximum viewport width (in px), default 1280px
/// @return {String} - CSS clamp() value
/// @example fluid-type(1rem, 2rem) // Scales from 1rem to 2rem between 320px and 1280px
@function fluid-type($min-size, $max-size, $min-vw: 320px, $max-vw: 1280px) {
  // Convert rem to px for calculation if needed
  $min-size-px: if(unit($min-size) == 'rem', $min-size * 16, $min-size);
  $max-size-px: if(unit($max-size) == 'rem', $max-size * 16, $max-size);

  // Calculate the slope
  $slope: calc(($max-size-px - $min-size-px) / ($max-vw - $min-vw));

  // Calculate the y-intercept
  $y-intercept: calc($min-size-px - ($slope * $min-vw));

  // Build the preferred value (slope * 100vw + y-intercept)
  $slope-vw: calc($slope * 100);

  @return clamp(#{$min-size}, #{$y-intercept} + #{$slope-vw}vw, #{$max-size});
}

/// Mixin for fluid typography with fallback
/// @param {Number} $min-size - Minimum font size
/// @param {Number} $max-size - Maximum font size
/// @param {Number} $min-vw - Minimum viewport width
/// @param {Number} $max-vw - Maximum viewport width
@mixin fluid-font($min-size, $max-size, $min-vw: 320px, $max-vw: 1280px) {
  font-size: $min-size; // Fallback
  font-size: fluid-type($min-size, $max-size, $min-vw, $max-vw);
}

// ===================================
// Heading Styles Map
// Pre-configured heading styles for consistency
// ===================================

$heading-styles: (
  'h1': (
    'size': var(--font-size-4xxl),
    'size-mobile': var(--font-size-xxl),
    'weight': var(--font-weight-bold),
    'line-height': 1.1,
    'letter-spacing': -0.02em,
  ),
  'h2': (
    'size': var(--font-size-3xxl),
    'size-mobile': var(--font-size-2xl),
    'weight': var(--font-weight-bold),
    'line-height': 1.2,
    'letter-spacing': -0.01em,
  ),
  'h3': (
    'size': var(--font-size-2xxl),
    'size-mobile': var(--font-size-xl),
    'weight': var(--font-weight-semibold),
    'line-height': 1.3,
    'letter-spacing': 0,
  ),
  'h4': (
    'size': var(--font-size-xxl),
    'size-mobile': var(--font-size-lg),
    'weight': var(--font-weight-semibold),
    'line-height': 1.4,
    'letter-spacing': 0,
  ),
  'h5': (
    'size': var(--font-size-xl),
    'size-mobile': var(--font-size-base),
    'weight': var(--font-weight-medium),
    'line-height': 1.5,
    'letter-spacing': 0,
  ),
  'h6': (
    'size': var(--font-size-lg),
    'size-mobile': var(--font-size-base),
    'weight': var(--font-weight-medium),
    'line-height': 1.5,
    'letter-spacing': 0,
  ),
);

/// Get heading style value
/// @param {String} $heading - Heading level (h1-h6)
/// @param {String} $property - Property to get
/// @return {*} - Property value
@function heading($heading, $property) {
  @if not map.has-key($heading-styles, $heading) {
    @error "Heading '#{$heading}' not found. Available: #{map.keys($heading-styles)}";
  }
  $styles: map.get($heading-styles, $heading);
  @if not map.has-key($styles, $property) {
    @error "Property '#{$property}' not found for #{$heading}. Available: #{map.keys($styles)}";
  }
  @return map.get($styles, $property);
}

// ===================================
// Usage Examples
// ===================================

/*
$brand-fonts: (
    "heading": 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif',
    "body": 'Segoe UI, Tahoma, Geneva, Verdana, sans-serif',
    "monospace": 'Courier New, Courier, monospace'
);

// Access colors
// Using CSS Variables
.example {
    font-family: var(--font-body);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-normal);
}

// Or
// Using SCSS Function
.example {
    font-family: font-family('body');
    font-size: font-size('base');
    font-weight: font-weight('normal');
}
*/